{% extends 'base.html' %}
{% block title %}Admin - Anti-Cheat{% endblock %}
{% block content %}
  <h2>Admin Dashboard</h2>
  <p><a class="btn btn-success" href="{{ url_for('add_user') }}">Add User</a></p>

  <div class="mb-3">
    <h5>Admin Actions</h5>
    <a class="btn btn-outline-secondary me-2" href="{{ url_for('change_own_password') }}">Change my password</a>
    <a class="btn btn-outline-info me-2" href="{{ url_for('export_users') }}">Export users (CSV)</a>
    <a class="btn btn-outline-warning" href="{{ url_for('manage_batches') }}">Manage batches</a>
  </div>

  <table class="table table-striped">
    <thead>
      <tr><th>ID</th><th>Username</th><th>Role</th><th>Actions</th></tr>
    </thead>
    <tbody>
      {% for u in users %}
        <tr>
          <td>{{ u.id }}</td>
          <td>{{ u.username }}</td>
          <td>{{ u.role }}</td>
          <td>
            <a class="btn btn-sm btn-primary" href="{{ url_for('edit_user', user_id=u.id) }}">Edit</a>
            {% if current_user.id != u.id %}
              <form method="post" action="{{ url_for('delete_user', user_id=u.id) }}" style="display:inline" onsubmit="return confirm('Delete user {{ u.username }}?');">
                <button class="btn btn-sm btn-danger" type="submit">Delete</button>
              </form>
            {% else %}
              <button class="btn btn-sm btn-secondary" disabled>Delete</button>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
